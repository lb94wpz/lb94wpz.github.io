function setMask(){return null!=document.getElementsByClassName("rmMask")[0]?document.getElementsByClassName("rmMask")[0]:((mask=document.createElement("div")).className="rmMask",mask.style.width=window.innerWidth+"px",mask.style.height=window.innerHeight+"px",mask.style.background="#fff",mask.style.opacity=".0",mask.style.position="fixed",mask.style.top="0",mask.style.left="0",mask.style.zIndex=998,document.body.appendChild(mask),document.getElementById("rightMenu").style.zIndex=19198,mask)}function insertAtCursor(e,t){var o,n,s;document.selection?(e.focus(),(sel=document.selection.createRange()).text=t,sel.select()):e.selectionStart||"0"==e.selectionStart?(o=e.selectionStart,n=e.selectionEnd,s=e.scrollTop,e.value=e.value.substring(0,o)+t+e.value.substring(n,e.value.length),0<s&&(e.scrollTop=s),e.focus(),e.selectionStart=o+t.length,e.selectionEnd=o+t.length):(e.value+=t,e.focus())}let rmf={};function popupMenu(){window.oncontextmenu=function(e){if("off"==mouseMode)return!0;$(".rightMenu-group.hide").hide(),document.getSelection().toString()&&$("#menu-text").show(),(document.getElementById("post")||document.getElementById("page"))&&$("#menu-post").show();var n=window.document.body,n=e.target;/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/.test(window.getSelection().toString())&&"A"!=n.tagName&&$("#menu-too").show(),"A"==n.tagName?($("#menu-to").show(),rmf.open=function(){-1==n.href.indexOf("http://")&&-1==n.href.indexOf("https://")||-1!=n.href.indexOf("yisous.xyz")?pjax.loadUrl(n.href):location.href=n.href},rmf.openWithNewTab=function(){window.open(n.href)},rmf.copyLink=function(){var e=n.href,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)}):"IMG"==n.tagName?($("#menu-img").show(),rmf.openWithNewTab=function(){window.open(n.src)},rmf.click=function(){n.click()},rmf.copyLink=function(){var e=n.src,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},rmf.saveAs=function(){var e=document.createElement("a"),t=n.src,o=t.split("/")[-1];e.href=t,e.download=o,e.click(),window.URL.revokeObjectURL(t)}):"TEXTAREA"!=n.tagName&&"INPUT"!=n.tagName||($("#menu-paste").show(),rmf.paste=function(){navigator.permissions.query({name:"clipboard-read"}).then(e=>{"granted"==e.state||"prompt"==e.state?navigator.clipboard.readText().then(e=>{console.log(e),insertAtCursor(n,e)}):Snackbar.show({text:"请允许读取剪贴板！",pos:"top-center",showAction:!1})})});let t=e.clientX+10,o=e.clientY;var e=$("#rightMenu").width(),s=$("#rightMenu").height();return t+e>window.innerWidth&&(t-=e+10),o+s>window.innerHeight&&(o-=o+s-window.innerHeight),mask=setMask(),$(".rightMenu-item").click(()=>{$(".rmMask").attr("style","display: none")}),$(window).resize(()=>{rmf.showRightMenu(!1),$(".rmMask").attr("style","display: none")}),mask.onclick=()=>{$(".rmMask").attr("style","display: none")},rmf.showRightMenu(!0,o,t),$(".rmMask").attr("style","display: flex"),!1},window.addEventListener("click",function(){rmf.showRightMenu(!1)})}function addLongtabListener(e,t){let o=0;e.ontouchstart=()=>{o=0,o=setTimeout(()=>{t(),o=0},380)},e.ontouchmove=()=>{clearTimeout(o),o=0},e.ontouchend=()=>{o&&clearTimeout(o)}}rmf.showRightMenu=function(e,t=0,o=0){var n=$("#rightMenu");n.css("top",t+"px").css("left",o+"px"),e?n.show():n.hide()},rmf.switchReadMode=function(){const t=document.body,o=(t.classList.add("read-mode"),document.createElement("button"));o.type="button",o.className="fas fa-sign-out-alt exit-readmode",t.appendChild(o),o.addEventListener("click",function e(){t.classList.remove("read-mode"),o.remove(),o.removeEventListener("click",e)})},rmf.copySelect=function(){document.execCommand("Copy",!1,null)},rmf.copyWordsLink=function(){var e=window.location.href,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},rmf.fullScreen=function(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},document.body.addEventListener("touchmove",function(){},{passive:!1}),navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)||popupMenu();const box=document.documentElement;addLongtabListener(box,popupMenu),null==localStorage.getItem("mouse")&&localStorage.setItem("mouse","on");var mouseMode=localStorage.getItem("mouse");function changeMouseMode(){"on"==localStorage.getItem("mouse")?(mouseMode="off",localStorage.setItem("mouse","off"),debounce(function(){new Vue({data:function(){this.$notify({title:"切换右键模式成功🍔",message:"当前鼠标右键已恢复为系统默认！",position:"top-left",offset:50,showClose:!0,type:"success",duration:5e3})}})},300)):(mouseMode="on",localStorage.setItem("mouse","on"),debounce(function(){new Vue({data:function(){this.$notify({title:"切换右键模式成功🍔",message:"当前鼠标右键已更换为网站指定样式！",position:"top-left",offset:50,showClose:!0,type:"success",duration:5e3})}})},300))}